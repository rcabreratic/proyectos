<!DOCTYPE html>
<html lang="es" xml:lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>A.9.4.- Obtener resultado de una actividad secundaria | Creación de una aplicación móvil </title>
<meta name="author" content="José Luis Camuñas Taguas" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<script type="text/javascript" src="SCORM_API_wrapper.js"></script>
<script type="text/javascript" src="SCOFunctions.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" /></head>
<body id="exe-node-91" class="exe-scorm" onunload="unloadPage()"><script type="text/javascript">document.body.className+=" js";jQuery(function(){loadPage()})</script>
<div id="outer">
<section id="main">
<header id="nodeDecoration"><div id="headerContent"><h1 id="nodeTitle">A.9.4.- Obtener resultado de una actividad secundaria</h1></div></header>
<article class="iDevice_wrapper FreeTextfpdIdevice" id="id430">
<div class="iDevice emphasis0">
<div id="ta430_69" class="block iDevice_content">
<div class="exe-figure exe-image float-right license-copyright" style="width: 349px;"><img src="App_Movil.png" width="349" height="200" alt="Ilustración que muestra esquemáticamente tres capturas de pantalla de una aplicación móvil." title="App móvil, con varias Activity." style="float: right;" />
<div class="figcaption"><a href="https://pixabay.com/vectors/whatsapp-interface-apps-android-1660652/" target="_blank" class="author" title="Acceder a la web de descarga de la imagen de 200degrees  en Pixabay. (Se abre en una nueva ventana)">200degrees</a> <span class="license"><span class="sep">(<a href="https://pixabay.com/service/license/" title="Acceder a los términos de la Licencia Pixabay. (Se abre en una nueva ventana)">Licencia Pixabay</a></span><span></span><span class="sep">)</span></span></div>
</div>
<p>Ya se ha comentado que la segunda actividad se inicializó con el método <code>startActivityForResult()</code> y debe devolver el resultado de su ejecución a la primer actividad en forma de <code>Intent</code>.  Esto se realiza mediante el siguiente código: </p>
<div class="codigo elemento_centrado" style="width: 26.900000000000002em;">
<div class="texto_izquierda">
<pre><code>setResult(int resultCode, Intent data)</code></pre>
</div>
</div>
<p></p>
<p>El primer parámetro <code>resultCode</code> indica si la actividad secundaria se ha ejecutado bien o no, pudiendo tomar los valores <code>RESULT_CANCELED</code> o <code>RESULT_OK</code> y el parámetro<code> data</code> contiene el <code>Intent</code> a devolver. Este <code>Intent</code> también puede tener parámetros que  la primera actividad necesite.</p>
<p>Para finalizar la actividad secundaria y que el control siga en la actividad principal debemos utilizar el método:</p>
<div class="codigo elemento_centrado" style="width: 10.95em;">
<div class="texto_izquierda">
<pre><code>finish():</code></pre>
</div>
</div>
<p></p>
<p>Vamos a seguir con el ejemplo planteado <code>HelloWorld</code><strong> </strong>y añadiremos un botón en la actividad secundaria para que al pulsar volvamos de nuevo a la actividad principal. Para ello además de dibujarlo en el fichero <span lang="en">layout</span> le asignaremos la funcionalidad tal y como hicimos en la pantalla principal, añadiendo el código siguiente en el fichero java de la actividad secundaria y diciendo que nuestra clase implemente el <span lang="en">interface</span> <code>OnClickListener</code>:</p>
<div class="codigo elemento_centrado" style="width: 31.85em;">
<div class="texto_izquierda">
<pre><span>btReturn</span>=findViewById(R.id.<span>btReturn</span>);<br /><span>btReturn</span>.setOnClickListener(<span>this</span>);</pre>
</div>
</div>
<p></p>
<p>Por último implementamos el método <code>onClick()</code> con el siguiente código:</p>
<div class="codigo elemento_centrado" style="width: 37.35em;">
<div class="texto_izquierda">
<pre><span>public void </span>onClick(View v){<br />    Intent data = <span>new </span>Intent();<br />   <strong> data.putExtra("return", "Venimos de la segunda pantalla");</strong><br />    setResult(<span>RESULT_OK</span>, data);<br />    finish();<br />}</pre>
</div>
</div>
<p></p>
<p>Volvemos a la actividad principal, ya que necesitamos sobrescribir el método <code>onActivityResult()</code> en  la clase<code> MainActivity </code>que se ejecuta automáticamente cuando la segunda actividad finaliza:</p>
<div class="codigo elemento_centrado" style="width: 48.900000000000006em;">
<div class="texto_izquierda">
<pre><span>@Override<br /></span><span>protected void </span>onActivityResult(<span>int </span>requestCode, <span>int </span>resultCode, Intent data) {<br />    <span>if </span>(requestCode == <span>REQUESTCODE_SECOND_ACTIVITY</span>){<br />        <span>if </span>(resultCode == <span>RESULT_OK</span>){<br />            String valor = (String) data.getExtras().get(<span>"return"</span>);<br />            Toast toast =<br />                    Toast.<span>makeText</span>(getApplicationContext(),<br />                            valor, Toast.<span>LENGTH_SHORT</span>);<br /><br />            toast.show();<br />        }<br />    }<br />}</pre>
</div>
</div>
<div id="gtx-trans" style="position: absolute; left: 180px; top: 1091.38px;">
<div class="gtx-trans-icon"></div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper RecomendacionfpdIdevice em_iDevice em_iDevice_recomendacionfpd" id="id431">
<div class="iDevice emphasis_recomendacionfpd" >
<header class="iDevice_header" style="background-image:url(icon_recomendacionfpd.png)"><h1 class="iDeviceTitle">Recomendación</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta431_46" class="block iDevice_content">
<p>En el siguiente enlace puedes descargarte el proyecto de ejemplo en su totalidad.</p>
<p class="enlace_centrado"><a class="paquete" title="Descargar el fichero del proyecto comprimido “HolaMundo” . Se abre en una nueva ventana [zip - 0.76 MB]" href="HelloWorld.zip" target="_blank">Aplicación de ejemplo sobre el paso de parámetros entre actividades</a><span class="exe-link-data file-size"> (zip - 0.76 <abbr lang="en" title="MegaBytes">MB</abbr>)</span>.<span class="tamano"><br /></span></p>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper VerdaderofalsofpdIdevice em_iDevice em_iDevice_autoevaluacionfpd" id="id432">
<div class="iDevice emphasis_autoevaluacionfpd" >
<header class="iDevice_header" style="background-image:url(icon_autoevaluacionfpd.gif)"><h1 class="iDeviceTitle">Autoevaluación</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta432_50" class="block iDevice_content">

</div>
<section class="question">
<form name="true-false-form-0b432" action="#" class="activity-form">
<h1 class="js-sr-av">Pregunta 1</h1>
<div id="taquestion0b432" class="block iDevice_content">
<p><strong>El m&eacute;todo utilizado para enviar datos a la otra actividad es <code>getExtras(clave).</code></strong></p>
</div>
<p class="iDevice_answer js-required">
<label for="true0b432"><input type="radio" name="option0b432" id="true0b432" class="exe-radio-option exe-radio-option-0-2-0b432-truefalse" /> Verdadero</label> 
<label for="false0b432"><input type="radio" name="option0b432" id="false0b432" class="exe-radio-option exe-radio-option-1-2-0b432-truefalse" /> Falso</label>
</p>
</form>
<section id="s0b432" class="feedback js-feedback js-hidden">
<h1 class="js-sr-av">Retroalimentación</h1>
<p><strong id="s0b432-result" class="wrong">Falso</strong></p>
<p>Es falso porque este m&eacute;todo recoge los valores enviados desde una actividad. El m&eacute;todo que env&iacute;a los datos es <code>putExtra(clave, valor)</code>.</p>
</section>
</section>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper EjercicioresueltofpdIdevice em_iDevice em_iDevice_ejercicioresueltofpd" id="id433">
<div class="iDevice emphasis_ejercicioresueltofpd" >
<header class="iDevice_header" style="background-image:url(icon_ejercicioresueltofpd.png)"><h1 class="iDeviceTitle">Ejercicio Propuesto</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<section id="ta433_63" class="block story iDevice_content">

</section>
<section id="taquesQuestion0b433" class="block iDevice_content">
<p><strong>Realiza una aplicación que contenga una actividad principal y dos actividades secundarias con el siguiente diseño:</strong></p>
<ul>
<li class="lista_verificacion">La actividad principal consistirá básicamente en:
<ul>
<li class="lista_verificacion">un objeto <code>EditText </code>donde el usuario pueda introducir su nombre;</li>
<li class="lista_verificacion">dos objetos <code>Button </code>para poder abrir cada una de las actividades secundarias;</li>
<li class="lista_verificacion">un objeto <code>TextView </code>donde se mostrará el contenido del parámetro pasado de cada una de las actividades secundarias.</li>
</ul>
</li>
<li class="lista_verificacion">Las actividades secundarias estarán formadas cada una de ellas por:
<ul>
<li class="lista_verificacion">un objeto <code>TextView </code>donde aparecerá el nombre del usuario que se le habrá pasado como parámetro desde la actividad principal;</li>
<li class="lista_verificacion">un objeto <code>EditText </code>para introducir una palabra;</li>
<li class="lista_verificacion">un objeto <code>Button </code>para poder regresar a la actividad principal.</li>
</ul>
</li>
</ul>
<p><strong>El funcionamiento de la aplicación será el siguiente:</strong></p>
<ol class="auto-numbered" style="list-style-type: decimal;">
<li>El usuario introduce su nombre en la pantalla principal y puede pulsar uno de los dos botones (<strong>Pantalla 1</strong> o <strong>Pantalla2</strong>).</li>
<li>A cada una de las dos pantallas se debe pasar como parámetro su nombre para que se escriba como texto en el objeto <code>TextView</code>.</li>
<li>Además, en cada pantalla el usuario podrá introducir una palabra de forma que al pulsar al botón "<strong>Volver</strong>" ésta se pasará a la pantalla principal como parámetro.</li>
<li>Al regresar a la pantalla principal, se debe visualizar la palabra pasada como parámetro en el objeto <code>TextView</code>.</li>
</ol>
</section>
<form name="feedback-form-quesFeedback0b433" action="#" onsubmit="return false" class="feedback-form">
<div class="block iDevice_buttons feedback-button js-required">
<p><script type="text/javascript">var feedbackquesFeedback0b433text = "Mostrar retroalimentación";</script><input type="button" name="toggle-feedback-quesFeedback0b433" value="Mostrar retroalimentación" class="feedbackbutton feedback-toggler" /></p>
</div>
<section id="feedback-quesFeedback0b433" class="feedback js-feedback js-hidden">
<h1 class="js-sr-av">Retroalimentación</h1>
<p>Te puedes basar el el proyecto HelloWorld que hemos hecho anteriormente. Sólo tienes que tener en cuenta los objetos View que debes implementar en cada pantalla y gestionar el paso de parámetros tal y como se ha hecho en el proyecto de ejemplo.</p>
<p>¡Ánimo que te servirá para practicar y entender mejor este apartado!</p>
<p style="text-align: center;"> </p></section>
</form>
</div>
</div>
</div>
</article>
</section>
<div id="packageLicense" class="cc cc-by-nc-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Licencia Creative Commons Reconocimiento No comercial Compartir igual 4.0</a></p>
</div>
</div>
<script type="text/javascript" src="_fpd_js.js"></script></body></html>