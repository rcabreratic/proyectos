<!DOCTYPE html>
<html lang="es" xml:lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>B.3.3.2.- Recuperación o consulta de registros | Creación de una aplicación móvil </title>
<meta name="author" content="José Luis Camuñas Taguas" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<script type="text/javascript" src="SCORM_API_wrapper.js"></script>
<script type="text/javascript" src="SCOFunctions.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" /></head>
<body id="exe-node-115" class="exe-scorm" onunload="unloadPage()"><script type="text/javascript">document.body.className+=" js";jQuery(function(){loadPage()})</script>
<div id="outer">
<section id="main">
<header id="nodeDecoration"><div id="headerContent"><h1 id="nodeTitle">B.3.3.2.- Recuperación o consulta de registros</h1></div></header>
<article class="iDevice_wrapper FreeTextfpdIdevice" id="id503">
<div class="iDevice emphasis0">
<div id="ta503_69" class="block iDevice_content">
<div class="exe-figure exe-image float-right license-gnu-gpl" style="width: 128px;"><img src="PMDM06_CONT_R21_mano.png" width="128" height="128" alt="Icono de una mano sosteniendo la bola del mundo." title="El mundo en tus manos" style="float: right;" />
<div class="figcaption"><a href="https://commons.wikimedia.org/wiki/File%3ACrystal_Clear_app_sharemanager.png" target="_blank" class="author" title="Acceder a la imagen  &quot;El Mundo en tus manos&quot;, de &quot;Everaldo Coelho and YellowIcon&quot;, en Wikimedia (Se abre en una nueva ventana)">Everaldo Coelho and YellowIcon</a> <span class="license"><span class="sep">(<span class="license"><span class="sep"></span><a href="https://en.wikipedia.org/wiki/GNU_Lesser_General_Public_License" target="_blank" title="Ir a la Licencia GNU Lesser/GPL. (Se abre en una nueva ventana">GNU Lesser GPL</a><span class="sep">)</span></span></span></span></div>
</div>
<p>Ya conocemos las distintas formas de manipular los registros con <span lang="en"><abbr title="Structure Query Language Light" lang="en">SQLite</abbr></span>; ahora vamos a aprender a recuperar los registros y mostrarlos.<br /><br />Si nos fijamos en la clase <code>SQLiteDatabase</code> encontramos dos métodos que nos pueden servir: <code>rawQuery()</code> y <code>query()</code>.</p>
<p>¿En qué situación utilizamos cada uno?</p>
<p>Al igual que pasa en las operaciones de manipulación de registros vamos a tener dos formas de ejecutar una sentencia de consulta:</p>
<ul class="lista_verificacion">
<li><code>rawQuery()</code>: ejecuta directamente la sentencia <acronym title="Structure Query Language" lang="en">SQL</acronym> de consulta que pasamos como parámetro.</li>
<li><code>query()</code>: utiliza varios parámetros para construir la sentencia a ejecutar.</li>
</ul>
<p>En cualquier caso, la ejecución de una sentencia de consulta nos devolverá un conjunto de registros en un objeto de tipo <code>Cursor</code> que hereda de la clase <code>SQLiteCursor</code>. Este cursor nos permite procesar de forma individual cada fila del resultado de la consulta. Inicialmente este cursor apunta a la posición previa de la primera fila con lo cual tenemos que mover el cursor al primer registro mediante el método booleano <span></span><code class=" prettyprinted"><span class="pln">moveToNext</span><span class="pun">()</span></code><span>. A continuación iremos iterando por</span> cada fila hasta llegar al final del resultado donde el método <code>moveToNext()</code> devolverá el valor <code>false</code> indicando que no hay más filas que procesar.</p>
<p>Veamos la primera opción de implementación, bastante sencilla, utilizando el método <code>rawQuery()</code>. Fíjate cómo también se podría pasar como segundo parámetro los argumentos de la condición tal y como vimos en el apartado anterior. En este ejemplo se pone a <code>null</code> porque no se necesita.</p>
<div class="codigo elemento_centrado" style="width: 43.95em;">
<div class="texto_izquierda">
<pre><code>Cursor cur = bd.rawQuery("SELECT campo1, campo2 FROM miTabla", null);</code></pre>
</div>
</div>
<p></p>
<p>Para utilizar el método <code>query()</code> debemos tener en cuenta los parámetros que se pasan:</p>
<ul class="lista_verificacion">
<li><strong>Nombre de la tabla</strong>.</li>
<li><strong>Array con los nombres de campos</strong>.</li>
<li><strong>Condición</strong>: la cláusula <code>WHERE</code> de la sentencia.</li>
<li><strong>Argumentos de la condición</strong>: que podemos dejar a <code>null</code> si no los necesitamos o bien pasarlos como parámetros en un <span lang="en">array</span>.</li>
<li><strong>Cláusula <code>GROUP BY</code></strong>  que podemos dejar a <code>null</code> si no los necesitamos.</li>
<li><strong>Cláusula <code>HAVING</code></strong> que podemos dejar a <code>null</code> si no los necesitamos.</li>
<li><strong>Cláusula <code>ORDER BY</code></strong>  que podemos dejar a <code>null</code> si no los necesitamos.</li>
</ul>
<p>Aquí se muestra un ejemplo de recuperación de registros utilizando este método:</p>
<div class="codigo elemento_centrado" style="width: 50em;">
<div class="texto_izquierda">
<pre><code>String[] misCampos = new String[] {"codigo", "nombre"}; </code></pre>
<pre><code>Cursor cur = bd.query("miTabla", misCampos, "campo1=1", null, null, null, null);</code></pre>
</div>
</div>
<p></p>
<p>Una vez recuperados los registros en el objeto <code>Cursor</code>, utilizamos los métodos <code>moveToFirst()</code> y <code>moveToNext()</code> que devuelven <code>true </code>en caso de haber realizado correctamente el movimiento correspondiente y los métodos <code>get*(índice_columna)</code> para obtener el valor de cada columna a través del índice y según su tipo de dato como muestra el siguiente ejemplo:</p>
<div class="codigo elemento_centrado" style="width: 30.750000000000004em;">
<div class="texto_izquierda">
<pre><code>if (cur.moveToFirst()) {</code></pre>
<pre><code>     do {</code></pre>
<pre><code>              int var1 = cur.getInt(0);</code></pre>
<pre><code>              String var2 = cur.getString(1);</code></pre>
<pre><code>     } while(cur.moveToNext());</code></pre>
<pre><code>}</code></pre>
</div>
</div>
<p><br />Con los valores de los campos en guardados en las distintas variables ya podremos mostrarlos por pantalla de la forma que más nos interese.</p>
<p> </p>
</div>
</div>
</article>
<article class="iDevice_wrapper ParasabermasfpdIdevice em_iDevice em_iDevice_parasabermasfpd" id="id504">
<div class="iDevice emphasis_parasabermasfpd" >
<header class="iDevice_header" style="background-image:url(icon_parasabermasfpd.png)"><h1 class="iDeviceTitle">Para saber más</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta504_43" class="block iDevice_content">
<p>Además de los métodos utilizados para recorrer el cursor y obtener los valores de sus campos, puedes consultar otros métodos que te pueden ser útiles en la documentación oficial de <span lang="en">Android</span>.</p>
<p style="text-align: center;"><a title="Acceder a la web oficial de Android sobre “La clase Cursor” (Se abre en una ventana nueva)" href="http://developer.android.com/reference/android/database/Cursor.html" target="_blank" class="html">Documentación oficial de la clase Cursor</a></p>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper VerdaderofalsofpdIdevice em_iDevice em_iDevice_autoevaluacionfpd" id="id505">
<div class="iDevice emphasis_autoevaluacionfpd" >
<header class="iDevice_header" style="background-image:url(icon_autoevaluacionfpd.gif)"><h1 class="iDeviceTitle">Autoevaluación</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta505_50" class="block iDevice_content">

</div>
<section class="question">
<form name="true-false-form-0b505" action="#" class="activity-form">
<h1 class="js-sr-av">Pregunta 1</h1>
<div id="taquestion0b505" class="block iDevice_content">
<p><strong>Para ejecutar una sentencia <acronym title="Structure Query Language" lang="en">SQL</acronym> de consulta podemos utilizar los métodos <code>query()</code>, <code>rawQuery()</code> y <code>execSQL()</code>.</strong></p>
</div>
<p class="iDevice_answer js-required">
<label for="true0b505"><input type="radio" name="option0b505" id="true0b505" class="exe-radio-option exe-radio-option-0-2-0b505-truefalse" /> Verdadero</label> 
<label for="false0b505"><input type="radio" name="option0b505" id="false0b505" class="exe-radio-option exe-radio-option-1-2-0b505-truefalse" /> Falso</label>
</p>
</form>
<section id="s0b505" class="feedback js-feedback js-hidden">
<h1 class="js-sr-av">Retroalimentación</h1>
<p><strong id="s0b505-result" class="wrong">Falso</strong></p>
<p>La afirmaci&oacute;n es falsa porque <code>execSQL()</code> se utiliza exclusivamente para sentencias de manipulaci&oacute;n de registros (inserci&oacute;n, actualizaci&oacute;n y eliminaci&oacute;n) que no devuelven ning&uacute;n registro.</p>
</section>
</section>
</div>
</div>
</div>
</article>
</section>
<div id="packageLicense" class="cc cc-by-nc-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Licencia Creative Commons Reconocimiento No comercial Compartir igual 4.0</a></p>
</div>
</div>
<script type="text/javascript" src="_fpd_js.js"></script></body></html>